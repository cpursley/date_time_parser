#!/bin/sh
set -e

previous_version="${1}"
release_version="${2}"

mix test
git add EXAMPLES.md

sed -i '' "s/$previous_version/$release_version/" README.md
sed -i '' "s/$previous_version/$release_version/" mix.exs
git add mix.exs
git add README.md

mix docs
git add doc

git tag -a "$release_version" -m "Release version $release_version"
git push origin "$release_version"

mix hex.build
mix hex.publish
